Ideally this would be in a MVC model where the queries, functions, and error handling would have separate files.
